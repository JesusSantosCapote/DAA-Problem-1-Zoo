\documentclass[article]{llncs}
%
\usepackage[utf8]{inputenc}
\usepackage[spanish]{babel}
\usepackage{graphicx}
% Used for displaying a sample figure. If possible, figure files should
% be included in EPS format.
%
% If you use the hyperref package, please uncomment the following line
% to display URLs in blue roman font according to Springer's eBook style:
% \renewcommand\UrlFont{\color{blue}\rmfamily}


\begin{document}
%
\title{Dise\~{n}o y An\'alisis de Algoritmos. Problema 1: El Zool\'ogico}
%
%\titlerunning{Abbreviated paper title}
% If the paper title is too long for the running head, you can set
% an abbreviated paper title here
%
\author{Jes\'us Santos Capote y Kenny Villalobos Morales}
%
\institute{Facultad de Matemática y Computación, Universidad de La Habana, La Habana, Cuba }
%
\maketitle              % typeset the header of the contribution
%
\section{Definici\'on del Problema}

En un zoológico un poco especial, se separa a los animales en dos 
hábitats diferentes de manera general. El hábitat para la reproducción 
solo acepta animales de la misma especie, mientras que el hábitat para 
la maduración admite animales de distintas especies, pero no de géneros 
distintos. El zoológico está pasando por una remodelación, ya que va 
a recibir n especies distintas de animales, cada una con un número 'a' 
de hembras y 'b' de machos, que puede ser distinto entre cada especie. 
En la remodelación se está pensando en construir salas de exhibición de 
los animales. Cada una se construirá para ser un hábitat de reproducción
 o de maduración, y cada sala podrá soportar un máximo de k animales, 
 lo cual es igual para todas las salas. Como el zoológico necesita ser 
 rentable y cada sala se cobra por separado, se quiere construir el 
 máximo número posible de salas que cumplan con los requerimientos 
 planteados y que, además, estén llenas de animales para el disfrute 
 de los visitantes. ¿Cuántas salas deberá construir el zoológico?

\section{Modelaci\'on del Problema}

Se tiene una matriz de dimensi\'on $2*n$, donde cada casilla contiene n\'umeros 
enteros. El problema consiste en hallar la cantidad m\'axima de grupos de 
tama\~{n}o $k$ que se pueden formar, donde cada elemento de un grupo es 
una unidad perteneciente a una casilla de la matriz. Adem\'as, todos los 
elementos de un grupo deben pertenecer a casillas de una misma fila o de 
una misma columna de la la matriz.

\section{Primera Aproximaci\'on}

Como primera soluci\'on se propone aplanar la matriz de entrada para 
obtener una lista de $T$ elementos, siendo $T$ la suma de todos los elementos de la matriz,
 donde en cada posici\'on hay un animal. 
Los animales son modelados como una clase \emph{Animal} que tiene dos 
atributos: \emph{gender}, fila a la que pertenece en la matriz (g\'enero),  
y \emph{specie}, columna a la que pertenece en la matriz (especie). Luego 
generar todas las permutaciones de la matriz aplanada y por cada una 
dividirla mediante \'indices en porciones de tamaño $k$, contar cuantas 
de estas porciones son grupos v\'alidos y actualizar, de ser necesario, el 
máximo;   

\subsection{Optimalidad}
Sea $S = [a_1, a_2, \dots, a_T]$ una distribución de los animales de la 
matriz aplanada, tal que la cantidad de porciones de tamaño $k$ que se pueden 
formar a partir de ella, que cumplen las restricciones del problema, sea máxima. 
Esta distribución $S$ es una permutación de los elementos de la matriz aplanada. 
El algoritmo propuesto revisa todas las permutaciones de la matriz aplanada y 
calcula la cantidad de grupos factibles, por tanto, revisa a $S$. Luego 
el algoritmo encuentra la respuesta óptima.

\subsection{Complejidad Temporal}

Aplanar la matriz tiene costo $O(T)$ donde T es la cantidad 
de animales. Computar todas las permutaciones de una lista 
de tamaño T tiene un costo $O(T!)$. La comprobación 
de cuántos grupos factibles contiene una permutación de T 
elementos tiene complejidad $O(T)$ y esta comprobación se realiza para cada permutación.
Luego por el teorema de la multiplicación contar cuantos grupos factibles tiene cada permutación 
tiene complejidad $O(T*T!)$. Luego el algoritmo 
tiene complejidad $O(T + T*T! + T)$ y por el teorema de la 
suma, la complejidad final es $O(T*T!)$.

\section{Segunda Aproximaci\'on}

Demostremos que existe un \'optimo que solo usa un grupo columna a lo sumo 
por columna:

Sea $a_i$ y $b_i$ los elementos de la columna $i$. Sea $a_i + b_i = c$.

$$c = p_c * k + r_c, \hspace{0,2cm} r_c < k$$

$p_c$, es la cantidad de grupos columna que se pueden formar en la columna $i$.

$$a_i = p_a * k + r_a, \hspace{0,2cm} r_a < k$$

$p_a$, es la cantidad de grupos fila que se pueden formar solo con los elementos de $a_i$.

$$b_i = p_b * k + r_b, \hspace{0,2cm} r_b < k$$

$p_b$, es la cantidad de grupos fila que se pueden formar solo con los elementos de $b_i$. Por tanto:

$$c = a_i + b_i = p_a * k + p_b * k + r_a + r_b, \hspace{0,2cm} r_a < k, r_b < k$$

$$c = (p_a + p_b)*k + r_a + r_b$$

con $r_a + r_b < 2k$.

Si $r_a + r_b < k$ entonces por el algoritmo de divisi\'on, la cantidad de grupos que 
se pueden formar en la columna $i$, $\lfloor\frac{c}{k}\rfloor$, es igual a la suma 
de $p_a$ (cantidad de grupos que se pueden formar solo con los elementos de $a_i$) mas 
$p_b$ (cantidad de grupos que se pueden formar solo con los elementos de $b_i$). Es decir, para este caso,
con formar solo grupos filas con los elementos de $a_i$ y $b_i$ se iguala la cantidad 
de grupos columnas que se pueden formar en la columna $i$. 

Si $k \leq r_a + r_b < 2k$ entonces $r_a + r_b = r' + k$ con $r' < k$, luego:

$$c = (p_a + p_b)*k + r' + k$$
$$c = (p_a + p_b + 1)*k + r', \hspace{0,2cm} r' < k$$

Esto significa que, por el algoritmo de divisi\'on, la cantidad de grupos que 
se pueden formar en la columna $i$, $\lfloor\frac{c}{k}\rfloor$, es igual a la suma 
de $p_a$ (cantidad de grupos que se pueden formar solo con los elementos de $a_i$) mas 
$p_b$ (cantidad de grupos que se pueden formar solo con los elementos de $b_i$) mas uno. 
Es decir, la cantdad de grupos $p_c$ que se pueden formar en una columna es igual a la cantidad $p_a + p_b + 1$ 
a lo sumo, con formar solo grupo filas con los elementos de $a_i$ y $b_i$
obtengo la cantidad m\'axima de grupos menos uno.

Por lo dicho anteriormente existe un \'optimo que tiene a lo sumo un grupo con elementos pertenecientes a una misma columna $i$
para cada $i$.

\subsection{Explicaci\'on del Algoritmo}

Partiendo de que solo se necesita tomar un grupo columna por columna a lo sumo y 
tomar el resto como grupos fila, el algoritmo para cada forma de seleccionar 
columnas prueba todas las formas de crear un grupo columna en cada columna seleccionada. 
Luego de tener un conjunto de columnas seleccionadas y una forma de crear grupos columna fijada se 
calcula la cantidad de grupos filas que se pueden formar y se suma a la cantidad de grupos columnas 
que se crearon. El retorno del algoritmo sera el mayor n\'umero computado de esta forma, que corresponde
al n\'umero máximo de grupos que se pueden crear cumpliendo las restricciones del problema.

\subsection{Complejidad Temporal}



\section{Tercera Aproximaci\'on}

Sea $M = \sum_{i=0}^{n}matriz[0, i]$, $F = \sum_{i=0}^{n}matriz[1, i]$ y 
$T = M + F$.

Sabemos que la cantidad máxima de grupos que se pueden formar es $\lfloor \frac{T}{k} \rfloor$.
Para toda posible entrada de datos del problema, la solución es mayor o igual que 
$\lfloor \frac{T}{k} \rfloor - 1$. Demostremos esto: 

%

Cumpliendo con las restricciones del problema, siempre es posible formar 
$\lfloor \frac{M}{k}\rfloor=p_1  + \lfloor \frac{F}{k}\rfloor=p_2 $ grupos factibles, 
donde cada unidad de los grupos pertenece a una misma fila, quedando $r_1$ y 
$r_2$ elementos residuales en cada fila respectivamente. Luego:

$$M = p_1 * k + r_1, \hspace{0,2 cm} r_1 < k$$
$$F = p_2 * k + r_2, \hspace{0,2 cm} r_2 < k$$
$$T = M + F = p_1 * k + p_2*k + r_1 + r_2$$

Como $r_1, r_2 < k$, entonces $r_1 + r_2 < 2k$. Luego, si $r_1 + r_2 < k$, tomando 
$r_3 = r_1 + r_2$, se cumple que:
$$T = (p_1 + p_2)k + r_3, \hspace{0,2 cm} r_3 < k$$
Luego $\lfloor \frac{T}{k}\rfloor = p_1 + p_2 = \lfloor \frac{M}{k}\rfloor  + \lfloor \frac{F}{k}\rfloor$

\vspace{0,2 cm}

Si $r_1 + r_2$ no es menor que $k$ entonces $r_1 + r_2 \geq k$, entonces $r_1 + r_2 = r_3 + k$
con $r_3 < k$. Luego se cumple que:

$$T = (p_1 + p_2)k + k + r_3 = (p_1 + p_2 + 1)k + r_3$$
Luego $\lfloor \frac{T}{k}\rfloor = p_1 + p_2 + 1$ entonces $\lfloor \frac{T}{k}\rfloor -1 = p_1 + p_2 = \lfloor \frac{M}{k}\rfloor  + \lfloor \frac{F}{k}\rfloor$

\vspace{0,2 cm}

Para el caso en que $r_1 + r_2 < k$, como $\lfloor \frac{T}{k}\rfloor = p_1 + p_2$ esta solución es factible 
y óptima.

Para el caso en que $r_1 + r_2 \geq k$, $p_1 + p_2 = \lfloor \frac{T}{k}\rfloor -1$ es 
la soluci\'on \'optima si no es posible crear grupos con elementos pertenecientes a una misma columna.

En otro caso, en el que existe $i$ tal que $a_i + b_i \geq k$, $p_1 + p_2$
no se garantiza, de momento, que sea una solución \'optima. Se podr\'ia 
buscar $i$ tal que $min(a_i, r_1) + min(b_i, r_2) \geq k$, para este caso 
bastar\'ia con asignar el resto de cada fila a $a_i$ y $b_i$ respectivamente
con ello se formar\'ia un grupo m\'as con elementos pertenecientes a una misma columna, 
sin disminuir la cantidad $p_1 + p_2$ de grupos que se pueden formar, logrando 
crear $p_1 + p_2 + 1$ grupos que es un resultado \'optimo.

Pero de no existir dicho $i$ no se garantiza a\'un que $p_1 + p_2$ sea 
un resultado \'optimo, cabe la posibilidad de que dejando de crear 
$m$ grupos con elementos pertenecientes a una misma fila se pudiesen 
formar $m+1$ grupos con elementos pertenecientes a una misma columna.
N\'otese que para las columnas $i$ tal que $a_i + b_i < k$ los elementos 
de $a_i$ y $b_i$ solo pueden ser utilizados para formar grupos de elementos
pertenecientes a una misma fila.

Esto se puede ver como el siguiente subproblema:

Se tiene una submatriz de la matriz $A$ de entrada donde solo est\'an 
las columnas $i$ pertenecientes a $A$ tal que $A[0, i] + A[1, i] \geq k$.
Sea $r_1 = M - p_1*k$ y $r_2 = F - p_2*k$, tal que $r_1, r_2 < k$ y 
$r_1 + r_2 \geq k$ ($p_1 + p_2 = \lfloor\frac{T}{k}\rfloor - 1$). ¿Es posible encontrar un conjunto de columnas $S$ de 
tamaño $m$ tal que pueda formar un grupo con elementos pertenecientes a 
una misma columna por cada columna en $S$, dejando de hacer $m-1$ grupos 
de elementos pertenecientes a una misma fila? ($\lfloor\frac{T}{k}\rfloor = p_1 + p_2 + m - (m-1)$)

Anteriormente se demostr\'o que existe un \'optimo que solo usa un grupo columna a lo sumo 
por columna
 

\end{document}